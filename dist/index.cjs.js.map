{"version":3,"file":"index.cjs.js","sources":["../src/uploader.js","../src/blobs.js","../src/download.js","../src/ethstorage/ethstorage.js","../src/ethstorage/ethstorage-node.js"],"sourcesContent":["import {ethers} from \"ethers\";\nimport {BlobEIP4844Transaction} from \"@ethereumjs/tx\";\nimport {Common, Hardfork} from \"@ethereumjs/common\";\nimport {loadKZG} from 'kzg-wasm';\n\nconst defaultAxios = require(\"axios\");\nconst axios = defaultAxios.create({\n    timeout: 50000,\n});\n\nfunction sleep(ms) {\n    return new Promise((resolve) => {\n        setTimeout(resolve, ms);\n    });\n}\n\nfunction parseBigintValue(value) {\n    if (typeof value == 'bigint') {\n        return '0x' + value.toString(16);\n    }\n    if (typeof value == 'object') {\n        const {_hex} = value;\n        const c = BigInt(_hex);\n        return '0x' + c.toString(16);\n    }\n    return value;\n}\n\nfunction padHex(hex) {\n    if (typeof (hex) === \"string\" && !hex.startsWith(\"0x\")) {\n        return \"0x\" + hex;\n    }\n    return hex;\n}\n\nfunction computeVersionedHash(commitment, blobCommitmentVersion) {\n    const computedVersionedHash = new Uint8Array(32);\n    computedVersionedHash.set([blobCommitmentVersion], 0);\n    const hash = ethers.getBytes(ethers.sha256(commitment));\n    computedVersionedHash.set(hash.subarray(1), 1);\n    return computedVersionedHash;\n}\n\nfunction commitmentsToVersionedHashes(commitment) {\n    return computeVersionedHash(commitment, 0x01);\n}\n\nconst MIN_BLOB_GASPRICE = 1n;\nconst BLOB_GASPRICE_UPDATE_FRACTION = 3338477n;\n\nfunction fakeExponential(factor, numerator, denominator) {\n    let i = 1n;\n    let output = 0n;\n    let numerator_accum = factor * denominator;\n    while (numerator_accum > 0n) {\n        output += numerator_accum;\n        numerator_accum = (numerator_accum * numerator) / (denominator * i);\n        i++;\n    }\n    return output / denominator;\n}\n\nexport class BlobUploader {\n    #kzg;\n    #jsonRpc;\n    #privateKey;\n    #provider;\n    #wallet;\n    #chainId;\n\n    constructor(rpc, pk) {\n        this.#jsonRpc = rpc;\n        this.#privateKey = padHex(pk);\n        this.#provider = new ethers.JsonRpcProvider(rpc);\n        this.#wallet = new ethers.Wallet(this.#privateKey, this.#provider);\n    }\n\n    async #getKzg() {\n        if (!this.#kzg) {\n            this.#kzg = await loadKZG();\n        }\n        return this.#kzg;\n    }\n\n    async sendRpcCall(method, parameters) {\n        try {\n            let response = await axios({\n                method: \"POST\",\n                url: this.#jsonRpc,\n                data: {\n                    jsonrpc: \"2.0\",\n                    method: method,\n                    params: parameters,\n                    id: 67\n                },\n            });\n            if(response.data.error) {\n                console.log(\"Response Error:\", response.data.error);\n                return null;\n            }\n            let returnedValue = response.data.result;\n            if (returnedValue === \"0x\") {\n                return null;\n            }\n            return returnedValue;\n        } catch (error) {\n            console.log('send error', error);\n            return null;\n        }\n    }\n\n    async sendRawTransaction(param) {\n        return await this.sendRpcCall(\"eth_sendRawTransaction\", [param]);\n    }\n\n    async getChainId() {\n        if (this.#chainId == null) {\n            this.#chainId = await this.sendRpcCall(\"eth_chainId\", []);\n        }\n        return this.#chainId;\n    }\n\n    async getNonce() {\n        return await this.#wallet.getNonce();\n    }\n\n    async getFee() {\n        return await this.#provider.getFeeData();\n    }\n\n    async getBlobGasPrice() {\n        // get current block\n        const block = await this.#provider.getBlock(\"latest\");\n        const excessBlobGas = BigInt(block.excessBlobGas);\n        return fakeExponential(MIN_BLOB_GASPRICE, excessBlobGas ,BLOB_GASPRICE_UPDATE_FRACTION);\n    }\n\n    async estimateGas(params) {\n        const limit = await this.sendRpcCall(\"eth_estimateGas\", [params]);\n        if (limit) {\n            return BigInt(limit);\n        }\n        return null;\n    }\n\n    async sendNormalTx(tx) {\n        let {chainId, nonce, to, value, data, maxPriorityFeePerGas, maxFeePerGas, gasLimit} = tx;\n        const txResponse = await this.#wallet.sendTransaction({\n            chainId,\n            nonce,\n            to,\n            value,\n            data,\n            maxPriorityFeePerGas,\n            maxFeePerGas,\n            gasLimit,\n        });\n        return txResponse.hash;\n    }\n\n    async sendTx(tx, blobs) {\n        if (!blobs) {\n            return this.sendNormalTx(tx);\n        }\n\n        // blobs\n        const kzg = await this.#getKzg();\n        const commitments = [];\n        const proofs = [];\n        const versionedHashes = [];\n        const hexHashes = [];\n        for (let i = 0; i < blobs.length; i++) {\n            commitments.push(kzg.blobToKzgCommitment(blobs[i]));\n            proofs.push(kzg.computeBlobKzgProof(blobs[i], commitments[i]));\n            const hash = commitmentsToVersionedHashes(commitments[i]);\n            versionedHashes.push(hash);\n            hexHashes.push(ethers.hexlify(hash));\n        }\n\n        const chain = await this.getChainId();\n        let {chainId, nonce, to, value, data, maxPriorityFeePerGas, maxFeePerGas, gasLimit, maxFeePerBlobGas} = tx;\n        if (chainId == null) {\n            chainId = chain;\n        } else {\n            chainId = BigInt(chainId);\n            if (chainId !== BigInt(chain)) {\n                throw Error('invalid network id')\n            }\n        }\n\n        if (nonce == null) {\n            nonce = await this.getNonce();\n        }\n\n        value = value == null ? '0x0' : BigInt(value);\n\n        if (gasLimit == null) {\n            const hexValue = parseBigintValue(value);\n            const params = {\n                from: this.#wallet.address,\n                to,\n                data,\n                value: hexValue,\n                blobVersionedHashes: hexHashes,\n            };\n            gasLimit = await this.estimateGas(params);\n            if (gasLimit == null) {\n                throw Error('estimateGas: execution reverted')\n            }\n        } else {\n            gasLimit = BigInt(gasLimit);\n        }\n\n        if (maxFeePerGas == null) {\n            const fee = await this.getFee();\n            maxPriorityFeePerGas = fee.maxPriorityFeePerGas * 6n / 5n;\n            maxFeePerGas = fee.maxFeePerGas * 6n / 5n;\n        } else {\n            maxFeePerGas = BigInt(maxFeePerGas);\n            maxPriorityFeePerGas = BigInt(maxPriorityFeePerGas);\n        }\n\n        if (maxFeePerBlobGas == null) {\n            maxFeePerBlobGas = await this.getBlobGasPrice();\n            maxFeePerBlobGas = maxFeePerBlobGas * 6n / 5n;\n        } else {\n            maxFeePerBlobGas = BigInt(maxFeePerBlobGas);\n        }\n\n\n        // send\n        const common = Common.custom(\n            {\n                name: 'custom-chain',\n                networkId: chainId,\n                chainId: chainId,\n            },\n            {\n                hardfork: Hardfork.Cancun,\n                customCrypto: {kzg},\n            }\n        );\n        const unsignedTx = new BlobEIP4844Transaction(\n            {\n                chainId,\n                nonce,\n                to,\n                value,\n                data,\n                maxPriorityFeePerGas,\n                maxFeePerGas,\n                gasLimit,\n                maxFeePerBlobGas,\n                blobVersionedHashes: versionedHashes,\n                blobs,\n                kzgCommitments: commitments,\n                kzgProofs: proofs,\n            },\n            {common}\n        );\n\n        const pk = ethers.getBytes(this.#privateKey);\n        const signedTx = unsignedTx.sign(pk);\n        const rawData = signedTx.serializeNetworkWrapper();\n\n        const hex = Buffer.from(rawData).toString('hex');\n        return await this.sendRawTransaction('0x' + hex);\n    }\n\n    async isTransactionMined(transactionHash) {\n        const txReceipt = await this.#provider.getTransactionReceipt(transactionHash);\n        if (txReceipt && txReceipt.blockNumber) {\n            return txReceipt;\n        }\n    }\n\n    async getTxReceipt(transactionHash) {\n        let txReceipt;\n        while (!txReceipt) {\n            txReceipt = await this.isTransactionMined(transactionHash);\n            if (txReceipt) break;\n            await sleep(5000);\n        }\n        return txReceipt;\n    }\n\n    async getBlobHash(blob) {\n        const kzg = await this.#getKzg();\n        const commit = kzg.blobToKzgCommitment(blob);\n        const localHash = commitmentsToVersionedHashes(commit);\n        const hash = new Uint8Array(32);\n        hash.set(localHash.subarray(0, 32 - 8));\n        return ethers.hexlify(hash);\n    }\n}\n","import {ethers} from \"ethers\";\n\nconst BlobTxBytesPerFieldElement         = 32;      // Size in bytes of a field element\nconst BlobTxFieldElementsPerBlob         = 4096;\nexport const BLOB_SIZE = BlobTxBytesPerFieldElement * BlobTxFieldElementsPerBlob;\nexport const BLOB_DATA_SIZE = 31 * BlobTxFieldElementsPerBlob;\n\nexport function EncodeBlobs(data) {\n    const len = data.length;\n    if (len === 0) {\n        throw Error('invalid blob data')\n    }\n\n    let blobIndex = 0;\n    let fieldIndex = -1;\n\n    const blobs = [new Uint8Array(BLOB_SIZE).fill(0)];\n    for (let i = 0; i < len; i += 31) {\n        fieldIndex++;\n        if (fieldIndex === BlobTxFieldElementsPerBlob) {\n            blobs.push(new Uint8Array(BLOB_SIZE).fill(0));\n            blobIndex++;\n            fieldIndex = 0;\n        }\n        let max = i + 31;\n        if (max > len) {\n            max = len;\n        }\n        blobs[blobIndex].set(data.subarray(i, max), fieldIndex * 32 + 1);\n    }\n    return blobs;\n}\n\nexport function DecodeBlob(blob) {\n    if (!blob) {\n        throw Error('invalid blob data')\n    }\n\n    blob = ethers.getBytes(blob);\n    if (blob.length < BLOB_SIZE) {\n        const newBlob = new Uint8Array(BLOB_SIZE).fill(0);\n        newBlob.set(blob);\n        blob = newBlob;\n    }\n\n    let data = [];\n    let j = 0\n    for (let i = 0; i < BlobTxFieldElementsPerBlob; i++) {\n        const chunk = blob.subarray(j + 1, j + 32);\n        data = [...data, ...chunk];\n        j += 32;\n    }\n    let i = data.length - 1;\n    for (; i >= 0; i--) {\n        if (data[i] !== 0x00) {\n            break\n        }\n    }\n    return data.slice(0, i + 1);\n}\n\nexport function DecodeBlobs(blobs) {\n    if (!blobs) {\n        throw Error('invalid blobs')\n    }\n\n    blobs = ethers.getBytes(blobs);\n    const len = blobs.length;\n    if (len === 0) {\n        throw Error('invalid blobs')\n    }\n\n    let buf = [];\n    for (let i = 0; i < len; i += BLOB_SIZE) {\n        let max = i + BLOB_SIZE;\n        if (max > len) {\n            max = len;\n        }\n        const blob = blobs.subarray(i, max);\n        const blobBuf = DecodeBlob(blob);\n        buf = [...buf, ...blobBuf];\n    }\n    return new Buffer(buf);\n}\n","import {ethers, Contract} from \"ethers\";\n\nconst contractABI = [\n    'function countChunks(bytes memory name) external view returns (uint256)',\n    'function readChunk(bytes memory name, uint256 chunkId) external view returns (bytes memory, bool)'\n]\n\nconst stringToHex = (s) => ethers.hexlify(ethers.toUtf8Bytes(s));\n\nasync function readChunk(ethStorageRpc, ethStorageAddress, hexName, index) {\n    let result;\n    try {\n        const provider = new ethers.JsonRpcProvider(ethStorageRpc);\n        const contract = new Contract(ethStorageAddress, contractABI, provider);\n        result = await contract.readChunk(hexName, index);\n    } catch (e) {\n        const provider = new ethers.JsonRpcProvider(ethStorageRpc);\n        const contract = new Contract(ethStorageAddress, contractABI, provider);\n        result = await contract.readChunk(hexName, index);\n    }\n    return ethers.getBytes(result[0]);\n}\n\nexport async function DownloadFile(ethStorageRpc, ethStorageAddress, fileName) {\n    const hexName = stringToHex(fileName);\n\n    const provider = new ethers.JsonRpcProvider(ethStorageRpc);\n    const contract = new Contract(ethStorageAddress, contractABI, provider);\n    const blobCount = await contract.countChunks(hexName);\n\n    let buff = [];\n    for (let i = 0; i < blobCount; i++) {\n        const chunk = await readChunk(ethStorageRpc, ethStorageAddress, hexName, i);\n        buff = [...buff, ...chunk];\n    }\n    return new Buffer(buff);\n}\n","import {ethers} from \"ethers\";\nimport {BlobUploader} from \"../uploader\";\nimport {EncodeBlobs, BLOB_DATA_SIZE} from \"../blobs\";\nimport {DownloadFile} from \"../download\";\n\nconst flatDirectoryBlobAbi = [\n    \"constructor(uint8 slotLimit, uint32 maxChunkSize, address storageAddress) public\",\n    \"function setDefault(bytes memory _defaultFile) public\",\n    \"function upfrontPayment() external view returns (uint256)\",\n    \"function getChunkHash(bytes memory name, uint256 chunkId) public view returns (bytes32)\",\n    \"function writeChunks(bytes memory name, uint256[] memory chunkIds, uint256[] memory sizes) external payable\",\n    \"function refund() public\",\n    \"function remove(bytes memory name) external returns (uint256)\",\n    \"function countChunks(bytes memory name) external view returns (uint256)\",\n    \"function isSupportBlob() view public returns (bool)\"\n];\n\nconst REMOVE_FAIL = -1;\nconst REMOVE_NORMAL = 0;\nconst REMOVE_SUCCESS = 1;\n\nconst MAX_BLOB_COUNT = 3;\n\nconst SEPOLIA_ETH_STORAGE = \"0x804C520d3c084C805E37A35E90057Ac32831F96f\";\nconst ES_TEST_RPC = \"http://65.108.236.27:9540\";\n\nconst stringToHex = (s) => ethers.hexlify(ethers.toUtf8Bytes(s));\n\nexport class BaseEthStorage {\n    #wallet;\n    #blobUploader;\n    #contractAddr;\n\n    constructor(rpc, privateKey, contractAddr = null) {\n        const provider = new ethers.JsonRpcProvider(rpc);\n        this.#wallet = new ethers.Wallet(privateKey, provider);\n        this.#blobUploader = new BlobUploader(rpc, privateKey);\n        this.#contractAddr = contractAddr;\n    }\n\n    async #deploy(ethStorage) {\n        const contractByteCode = '0x60c0604052600060a09081526006906200001a9082620001ac565b503480156200002857600080fd5b50604051620038d0380380620038d08339810160408190526200004b9162000278565b60ff831660805282828281816200006233620000b5565b6002805463ffffffff909316600160a01b0263ffffffff60a01b1990931692909217909155600380546001600160a01b039092166001600160a01b031990921691909117905550620002e4945050505050565b600280546001600160a01b038381166001600160a01b0319831681179093556040519116919082907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e090600090a35050565b634e487b7160e01b600052604160045260246000fd5b600181811c908216806200013257607f821691505b6020821081036200015357634e487b7160e01b600052602260045260246000fd5b50919050565b601f821115620001a757600081815260208120601f850160051c81016020861015620001825750805b601f850160051c820191505b81811015620001a3578281556001016200018e565b5050505b505050565b81516001600160401b03811115620001c857620001c862000107565b620001e081620001d984546200011d565b8462000159565b602080601f831160018114620002185760008415620001ff5750858301515b600019600386901b1c1916600185901b178555620001a3565b600085815260208120601f198616915b82811015620002495788860151825594840194600190910190840162000228565b5085821015620002685787850151600019600388901b60f8161c191681555b5050505050600190811b01905550565b6000806000606084860312156200028e57600080fd5b835160ff81168114620002a057600080fd5b602085015190935063ffffffff81168114620002bb57600080fd5b60408501519092506001600160a01b0381168114620002d957600080fd5b809150509250925092565b6080516135c962000307600039600081816105500152611e9301526135c96000f3fe608060405260043610620001ee5760003560e01c8063590e1ae3116200010f578063caf1283611620000a3578063dd473fae116200006d578063dd473fae1462000776578063f14c7ad71462000794578063f2fde38b14620007ac578063f916c5b014620007d157620001ee565b8063caf1283614620006b5578063cf86bf9314620006f0578063d84eb56c146200072c578063dc38b0a2146200075157620001ee565b80638bf4515c11620000e55780638bf4515c14620006005780638da5cb5b146200062557806393b7628f1462000645578063956a3433146200069057620001ee565b8063590e1ae314620005ab5780635ba1d9e514620005c3578063715018a614620005e857620001ee565b80631ccbc6da116200018757806342216bed116200015d57806342216bed1462000504578063492c7b2a14620005295780634eed7cf1146200054057806358edef4c146200058657620001ee565b80631ccbc6da14620004ae5780631fbfa12714620004d55780632b68b9c614620004ec57620001ee565b806311ce026711620001c957806311ce026714620003de5780631a7237e014620004195780631c5ee10c146200044e5780631c993ad5146200048957620001ee565b8063038cd79f14620003705780630936286114620003895780631089f40f14620003b9575b348015620001fb57600080fd5b506000366060808284036200022157505060408051602081019091526000815262000365565b8383600081811062000237576200023762002a5f565b9050013560f81c60f81b6001600160f81b031916602f60f81b146200028357505060408051808201909152600e81526d0d2dcc6dee4e4cac6e840e0c2e8d60931b602082015262000365565b83836200029260018262002a8b565b818110620002a457620002a462002a5f565b909101356001600160f81b031916602f60f81b0390506200030657620002fd620002d2846001818862002aa1565b6006604051602001620002e89392919062002b03565b604051602081830303815290604052620007f6565b50905062000358565b6200035462000319846001818862002aa1565b8080601f016020809104026020016040519081016040528093929190818152602001838380828437600092019190915250620007f692505050565b5090505b6200036381620008a1565b505b915050805190602001f35b620003876200038136600462002ca3565b620008e2565b005b3480156200039657600080fd5b50620003a16200092c565b604051620003b0919062002d66565b60405180910390f35b348015620003c657600080fd5b5062000387620003d836600462002d7b565b620009c2565b348015620003eb57600080fd5b5060035462000400906001600160a01b031681565b6040516001600160a01b039091168152602001620003b0565b3480156200042657600080fd5b506200043e6200043836600462002da3565b62000a15565b604051620003b092919062002deb565b3480156200045b57600080fd5b50620004736200046d36600462002e11565b62000ac5565b60408051928352602083019190915201620003b0565b3480156200049657600080fd5b5062000387620004a836600462002e11565b62000b58565b348015620004bb57600080fd5b50620004c662000b97565b604051908152602001620003b0565b62000387620004e636600462002ed9565b62000c0d565b348015620004f957600080fd5b506200038762000d92565b3480156200051157600080fd5b50620004c66200052336600462002da3565b62000dcd565b620003876200053a36600462002f6a565b62000e78565b3480156200054d57600080fd5b507f000000000000000000000000000000000000000000000000000000000000000060ff1615155b6040519015158152602001620003b0565b3480156200059357600080fd5b50620004c6620005a536600462002e11565b62000f8f565b348015620005b857600080fd5b506200038762001057565b348015620005d057600080fd5b5062000575620005e236600462002da3565b620010c1565b348015620005f557600080fd5b506200038762001181565b3480156200060d57600080fd5b506200043e6200061f36600462002e11565b620007f6565b3480156200063257600080fd5b506002546001600160a01b031662000400565b3480156200065257600080fd5b50620006816200066436600462002e11565b805160209182012060009081526005909152604090205460ff1690565b604051620003b0919062002ff6565b3480156200069d57600080fd5b50620004c6620006af36600462003013565b620011bc565b348015620006c257600080fd5b50620006da620006d436600462002da3565b62001276565b60408051928352901515602083015201620003b0565b348015620006fd57600080fd5b506002546200071690600160a01b900463ffffffff1681565b60405163ffffffff9091168152602001620003b0565b3480156200073957600080fd5b50620004c66200074b36600462002da3565b6200130c565b3480156200075e57600080fd5b50620003876200077036600462003036565b620013c2565b3480156200078357600080fd5b50651b585b9d585b60d21b620004c6565b348015620007a157600080fd5b506200057562001411565b348015620007b957600080fd5b5062000387620007cb36600462003036565b6200143d565b348015620007de57600080fd5b50620004c6620007f036600462002e11565b620014dc565b60606000806200081d84805160209182012060009081526005909152604090205460ff1690565b9050600281600281111562000836576200083662002fe0565b0362000858576200084e848051906020012062001561565b9250925050915091565b60018160028111156200086f576200086f62002fe0565b0362000887576200084e848051906020012062001761565b505060408051600080825260208201909252939092509050565b600081516040620008b3919062003061565b9050601f19620008c582602062003061565b620008d290601f62003061565b1690506020808303528060208303f35b6002546001600160a01b03163314620009185760405162461bcd60e51b81526004016200090f9062003077565b60405180910390fd5b62000927836000848462000e78565b505050565b600680546200093b9062002acd565b80601f0160208091040260200160405190810160405280929190818152602001828054620009699062002acd565b8015620009ba5780601f106200098e57610100808354040283529160200191620009ba565b820191906000526020600020905b8154815290600101906020018083116200099c57829003601f168201915b505050505081565b6002546001600160a01b03163314620009ef5760405162461bcd60e51b81526004016200090f9062003077565b6002805463ffffffff909216600160a01b0263ffffffff60a01b19909216919091179055565b606060008062000a3c85805160209182012060009081526005909152604090205460ff1690565b9050600281600281111562000a555762000a5562002fe0565b0362000a795762000a6e8580519060200120856200188e565b925092505062000abe565b600181600281111562000a905762000a9062002fe0565b0362000aa95762000a6e8580519060200120856200196b565b50506040805160008082526020820190925291505b9250929050565b600080600062000aec84805160209182012060009081526005909152604090205460ff1690565b9050600281600281111562000b055762000b0562002fe0565b0362000b1d576200084e8480519060200120620019e4565b600181600281111562000b345762000b3462002fe0565b0362000b4c576200084e848051906020012062001abb565b50600093849350915050565b6002546001600160a01b0316331462000b855760405162461bcd60e51b81526004016200090f9062003077565b600662000b938282620030f6565b5050565b60035460408051630e65e36d60e11b815290516000926001600160a01b031691631ccbc6da9160048083019260209291908290030181865afa15801562000be2573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062000c089190620031c2565b905090565b6002546001600160a01b0316331462000c3a5760405162461bcd60e51b81526004016200090f9062003077565b62000c4462001411565b62000cab5760405162461bcd60e51b815260206004820152603060248201527f5468652063757272656e74206e6574776f726b20646f6573206e6f742073757060448201526f1c1bdc9d08189b1bd8881d5c1b1bd85960821b60648201526084016200090f565b600062000ccf84805160209182012060009081526005909152604090205460ff1690565b9050600081600281111562000ce85762000ce862002fe0565b148062000d095750600281600281111562000d075762000d0762002fe0565b145b62000d4e5760405162461bcd60e51b8152602060048201526014602482015273496e76616c69642073746f72616765206d6f646560601b60448201526064016200090f565b600081600281111562000d655762000d6562002fe0565b0362000d785762000d7884600262001b12565b62000d8c8480519060200120848462001b54565b50505050565b6002546001600160a01b0316331462000dbf5760405162461bcd60e51b81526004016200090f9062003077565b6002546001600160a01b0316ff5b60008062000df284805160209182012060009081526005909152604090205460ff1690565b9050600281600281111562000e0b5762000e0b62002fe0565b0362000e2d5762000e24848051906020012084620011bc565b91505062000e72565b600181600281111562000e445762000e4462002fe0565b0362000e6c57600062000e58858562000a15565b508051602090910120925062000e72915050565b50600090505b92915050565b6002546001600160a01b0316331462000ea55760405162461bcd60e51b81526004016200090f9062003077565b600062000ec985805160209182012060009081526005909152604090205460ff1690565b9050600081600281111562000ee25762000ee262002fe0565b148062000f035750600181600281111562000f015762000f0162002fe0565b145b62000f485760405162461bcd60e51b8152602060048201526014602482015273496e76616c69642073746f72616765206d6f646560601b60448201526064016200090f565b600081600281111562000f5f5762000f5f62002fe0565b0362000f725762000f7285600162001b12565b62000f8885805190602001208585853462001e83565b5050505050565b6002546000906001600160a01b0316331462000fbf5760405162461bcd60e51b81526004016200090f9062003077565b600062000fe383805160209182012060009081526005909152604090205460ff1690565b9050600281600281111562000ffc5762000ffc62002fe0565b036200101d57620010168380519060200120600062001f6c565b9392505050565b600181600281111562001034576200103462002fe0565b036200104e57620010168380519060200120600062001fcc565b50600092915050565b6002546001600160a01b03163314620010845760405162461bcd60e51b81526004016200090f9062003077565b6002546040516001600160a01b03909116904780156108fc02916000818181858888f19350505050158015620010be573d6000803e3d6000fd5b50565b6002546000906001600160a01b03163314620010f15760405162461bcd60e51b81526004016200090f9062003077565b60006200111584805160209182012060009081526005909152604090205460ff1690565b905060028160028111156200112e576200112e62002fe0565b03620011475762000e248480519060200120846200208e565b60018160028111156200115e576200115e62002fe0565b03620011775762000e2484805190602001208462002116565b5060009392505050565b6002546001600160a01b03163314620011ae5760405162461bcd60e51b81526004016200090f9062003077565b620011ba600062002206565b565b6000620011c98362002258565b8210620011d95750600062000e72565b60035460008481526004602081815260408084208785529091529182902054915163d8389dc560e01b8152908101919091526001600160a01b039091169063d8389dc590602401602060405180830381865afa1580156200123e573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620012649190620031dc565b67ffffffffffffffff19169392505050565b60008060006200129d85805160209182012060009081526005909152604090205460ff1690565b90506002816002811115620012b657620012b662002fe0565b03620012cf5762000a6e85805190602001208562002299565b6001816002811115620012e657620012e662002fe0565b03620012ff5762000a6e8580519060200120856200234d565b5060009485945092505050565b6002546000906001600160a01b031633146200133c5760405162461bcd60e51b81526004016200090f9062003077565b60006200136084805160209182012060009081526005909152604090205460ff1690565b9050600281600281111562001379576200137962002fe0565b03620013925762000e2484805190602001208462001f6c565b6001816002811115620013a957620013a962002fe0565b03620011775762000e2484805190602001208462001fcc565b6002546001600160a01b03163314620013ef5760405162461bcd60e51b81526004016200090f9062003077565b600380546001600160a01b0319166001600160a01b0392909216919091179055565b6003546000906001600160a01b03161580159062000c08575060006200143662000b97565b1015905090565b6002546001600160a01b031633146200146a5760405162461bcd60e51b81526004016200090f9062003077565b6001600160a01b038116620014d15760405162461bcd60e51b815260206004820152602660248201527f4f776e61626c653a206e6577206f776e657220697320746865207a65726f206160448201526564647265737360d01b60648201526084016200090f565b620010be8162002206565b6000806200150183805160209182012060009081526005909152604090205460ff1690565b905060028160028111156200151a576200151a62002fe0565b03620015325762001016838051906020012062002258565b600181600281111562001549576200154962002fe0565b036200104e57620010168380519060200120620023a5565b606060008060006200157385620019e4565b9150915080600003620015bb5760005b6040519080825280601f01601f191660200182016040528015620015ae576020820181803683370190505b5095600095509350505050565b6000826001600160401b03811115620015d857620015d862002b90565b6040519080825280601f01601f19166020018201604052801562001603576020820181803683370190505b5090506000805b838110156200175257600088815260046020818152604080842085855290915280832054600354915163afd5644d60e01b815292830181905292916001600160a01b039091169063afd5644d90602401602060405180830381865afa15801562001678573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200169e9190620031c2565b60035460405163bea94b8b60e01b81529192506001600160a01b03169063bea94b8b90620016d9908590600190600090879060040162003209565b600060405180830381865afa158015620016f7573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526200172191908101906200323e565b508060406020868801013e62001738818562003061565b9350505080806200174990620032bd565b9150506200160a565b50909660019650945050505050565b60606000806000620017738562001abb565b91509150806000036200178857600062001583565b6000826001600160401b03811115620017a557620017a562002b90565b6040519080825280601f01601f191660200182016040528015620017d0576020820181803683370190505b5090506020810160005b838110156200175257600088815260208181526040808320848452909152812054906200180782620023e4565b156200184957620018188260e01c90565b60008b8152600160209081526040808320878452909152902090915062001841908386620023f9565b505062001868565b816200185581620024ad565b50915062001864818662002513565b5050505b62001874818562003061565b9350505080806200188590620032bd565b915050620017da565b60606000806200189f858562002299565b5090506001811015620018c657505060408051600080825260208201909252915062000abe565b600354600086815260046020818152604080842089855290915280832054905163bea94b8b60e01b815292936001600160a01b03169263bea94b8b92620019169291600191879189910162003209565b600060405180830381865afa15801562001934573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526200195e91908101906200323e565b9660019650945050505050565b600082815260208181526040808320848452909152812054606091906200199281620023e4565b15620019cc5760008581526001602090815260408083208784529091528120620019bd908362002572565b93506001925062000abe915050565b80620019d88162002619565b93509350505062000abe565b6000806000620019f48462002258565b90506000805b8281101562001ab15760035460008781526004602081815260408084208685529091529182902054915163afd5644d60e01b8152908101919091526001600160a01b039091169063afd5644d90602401602060405180830381865afa15801562001a68573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001a8e9190620031c2565b62001a9a908362003061565b91508062001aa881620032bd565b915050620019fa565b5094909350915050565b6000806000805b60008062001ad187846200234d565b915091508062001ae357505062001b08565b62001aef828562003061565b93508262001afd81620032bd565b935050505062001ac2565b9094909350915050565b81516020808401919091206000908152600590915260409020805482919060ff1916600183600281111562001b4b5762001b4b62002fe0565b02179055505050565b815160035460408051630e65e36d60e11b815290516000926001600160a01b031691631ccbc6da9160048083019260209291908290030181865afa15801562001ba1573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001bc79190620031c2565b905062001bd58282620032d9565b34101562001c1d5760405162461bcd60e51b8152602060048201526014602482015273696e73756666696369656e742062616c616e636560601b60448201526064016200090f565b60005b828160ff16101562001e7b57838160ff168151811062001c445762001c4462002a5f565b6020026020010151600010801562001c935750600260149054906101000a900463ffffffff1663ffffffff16848260ff168151811062001c885762001c8862002a5f565b602002602001015111155b62001cd85760405162461bcd60e51b81526020600482015260146024820152730d2dcecc2d8d2c840c6d0eadcd640d8cadccee8d60631b60448201526064016200090f565b62001d0386868360ff168151811062001cf55762001cf562002a5f565b6020026020010151620026bf565b60003387878460ff168151811062001d1f5762001d1f62002a5f565b602002602001015160405160200162001d56939291906001600160a01b039390931683526020830191909152604082015260600190565b604051602081830303815290604052805190602001209050600360009054906101000a90046001600160a01b03166001600160a01b0316634581a920848385898760ff168151811062001dad5762001dad62002a5f565b60200260200101516040518563ffffffff1660e01b815260040162001de89392919092835260ff919091166020830152604082015260600190565b6000604051808303818588803b15801562001e0257600080fd5b505af115801562001e17573d6000803e3d6000fd5b505050505080600460008981526020019081526020016000206000888560ff168151811062001e4a5762001e4a62002a5f565b602002602001015181526020019081526020016000208190555050808062001e7290620032f3565b91505062001c20565b505050505050565b62001e8f85856200275d565b60ff7f00000000000000000000000000000000000000000000000000000000000000001682111562001ef65762001ed862001ecc84848462002875565b6001600160a01b031690565b60008681526020818152604080832088845290915290205562000f88565b60008581526001602090815260408083208784528252918290208251601f860183900483028101830190935284835262001f4d92909186908690819084018382808284376000920191909152506200293192505050565b6000868152602081815260408083208884529091529020555050505050565b60005b60008381526004602090815260408083208584529091529020548062001f96575062001fc6565b60008481526004602090815260408083208684529091528120558262001fbc81620032bd565b9350505062001f6f565b50919050565b60005b6000838152602081815260408083208584529091529020548062001ff4575062001fc6565b62001fff81620023e4565b62002060576000819050806001600160a01b0316632b68b9c66040518163ffffffff1660e01b8152600401600060405180830381600087803b1580156200204557600080fd5b505af11580156200205a573d6000803e3d6000fd5b50505050505b600084815260208181526040808320868452909152812055826200208481620032bd565b9350505062001fcf565b600082815260046020908152604080832084845290915281205480620020b957600091505062000e72565b600084815260046020526040812081620020d586600162003061565b81526020019081526020016000205414620020f557600091505062000e72565b50506000918252600460209081526040808420928452919052812055600190565b600082815260208181526040808320848452909152812054806200213f57600091505062000e72565b6000848152602081905260408120816200215b86600162003061565b815260200190815260200160002054146200217b57600091505062000e72565b6200218681620023e4565b620021e7576000819050806001600160a01b0316632b68b9c66040518163ffffffff1660e01b8152600401600060405180830381600087803b158015620021cc57600080fd5b505af1158015620021e1573d6000803e3d6000fd5b50505050505b5050600091825260208281526040808420928452919052812055600190565b600280546001600160a01b038381166001600160a01b0319831681179093556040519116919082907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e090600090a35050565b6000805b60008381526004602090815260408083208484529091529020548062002283575062000e72565b816200228f81620032bd565b925050506200225c565b600080620022a78462002258565b8310620022ba5750600090508062000abe565b600354600085815260046020818152604080842088855290915280832054905163afd5644d60e01b81529182015290916001600160a01b03169063afd5644d90602401602060405180830381865afa1580156200231b573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620023419190620031c2565b95600195509350505050565b6000828152602081815260408083208484529091528120548190806200237b57600080925092505062000abe565b6200238681620023e4565b1562002399576000620019bd8260e01c90565b80620019d881620024ad565b6000805b60008381526020818152604080832084845290915290205480620023ce575062000e72565b81620023da81620032bd565b92505050620023a9565b600080620023f28360e01c90565b1192915050565b60008060006200240985620029cb565b808652909350905083601c8411156200249f57601c81016000805b6020600162002435601c8a62002a8b565b6200244290602062003061565b6200244e919062002a8b565b6200245a919062003315565b8110156200249b57600081815260208b815260409091205480855292506200248490849062003061565b9250806200249281620032bd565b91505062002424565b5050505b600192505050935093915050565b6000806001600160a01b038316620024ca57506000928392509050565b60008060405180610160016040528061012681526020016200346e6101269139519050843b91508082101562002507575060009485945092505050565b62002341818362002a8b565b6000806000806200252486620024ad565b91509150806200253d5760008093509350505062000abe565b600060405180610160016040528061012681526020016200346e6101269139519050828187893c509095600195509350505050565b606060006200258183620029e6565b92509050601c8111156200261257603c82016000805b60206001620025a8601c8762002a8b565b620025b590602062003061565b620025c1919062002a8b565b620025cd919062003315565b8110156200260e57600081815260208881526040909120548085529250620025f790849062003061565b9250806200260581620032bd565b91505062002597565b5050505b5092915050565b606060008060006200262b85620024ad565b91509150806200263d57600062001583565b6000826001600160401b038111156200265a576200265a62002b90565b6040519080825280601f01601f19166020018201604052801562002685576020820181803683370190505b509050600060405180610160016040528061012681526020016200346e6101269139519050838160208401893c5095600195509350505050565b60008281526004602090815260408083208484529091529020548062000927578115806200271657506000838152600460205260408120816200270460018662002a8b565b81526020019081526020016000205414155b620009275760405162461bcd60e51b81526020600482015260166024820152751b5d5cdd081c995c1b1858d9481bdc88185c1c195b9960521b60448201526064016200090f565b60008281526020818152604080832084845290915290205480620027f957811580620027b25750600083815260208190526040812081620027a060018662002a8b565b81526020019081526020016000205414155b620027f95760405162461bcd60e51b81526020600482015260166024820152751b5d5cdd081c995c1b1858d9481bdc88185c1c195b9960521b60448201526064016200090f565b6200280481620023e4565b6200092757806001600160a01b0381161562000d8c57806001600160a01b0316632b68b9c66040518163ffffffff1660e01b8152600401600060405180830381600087803b1580156200285657600080fd5b505af11580156200286b573d6000803e3d6000fd5b5050505050505050565b60008060405180610160016040528061012681526020016200346e61012691398585604051602001620028ab9392919062003338565b60408051601f1981840301815291905290506000620028cd6043602062003061565b30838201529050620028e2608c602062003061565b905030818301525060008382604051620028fc9062002a51565b62002908919062002d66565b6040518091039082f090508015801562002926573d6000803e3d6000fd5b509695505050505050565b805160208083015160e083901b911c1790601c81111562002612576000603c8401815b6020600162002965601c8762002a8b565b6200297290602062003061565b6200297e919062002a8b565b6200298a919062003315565b8110156200260e5781519250620029a382602062003061565b6000828152602089905260409020849055915080620029c281620032bd565b91505062002954565b600080620029d98360e01c90565b9360209390931b92915050565b60006060620029f58360e01c90565b9150602083901b9250816001600160401b0381111562002a195762002a1962002b90565b6040519080825280601f01601f19166020018201604052801562002a44576020820181803683370190505b5060208101939093525091565b61010b806200336383390190565b634e487b7160e01b600052603260045260246000fd5b634e487b7160e01b600052601160045260246000fd5b8181038181111562000e725762000e7262002a75565b6000808585111562002ab257600080fd5b8386111562002ac057600080fd5b5050820193919092039150565b600181811c9082168062002ae257607f821691505b60208210810362001fc657634e487b7160e01b600052602260045260246000fd5b828482376000838201600081526000845462002b1f8162002acd565b6001828116801562002b3a576001811462002b505762002b81565b60ff198416865282151583028601945062002b81565b8860005260208060002060005b8581101562002b785781548982015290840190820162002b5d565b50505082860194505b50929998505050505050505050565b634e487b7160e01b600052604160045260246000fd5b604051601f8201601f191681016001600160401b038111828210171562002bd15762002bd162002b90565b604052919050565b60006001600160401b0382111562002bf55762002bf562002b90565b50601f01601f191660200190565b600082601f83011262002c1557600080fd5b813562002c2c62002c268262002bd9565b62002ba6565b81815284602083860101111562002c4257600080fd5b816020850160208301376000918101602001919091529392505050565b60008083601f84011262002c7257600080fd5b5081356001600160401b0381111562002c8a57600080fd5b60208301915083602082850101111562000abe57600080fd5b60008060006040848603121562002cb957600080fd5b83356001600160401b038082111562002cd157600080fd5b62002cdf8783880162002c03565b9450602086013591508082111562002cf657600080fd5b5062002d058682870162002c5f565b9497909650939450505050565b60005b8381101562002d2f57818101518382015260200162002d15565b50506000910152565b6000815180845262002d5281602086016020860162002d12565b601f01601f19169290920160200192915050565b60208152600062001016602083018462002d38565b60006020828403121562002d8e57600080fd5b813563ffffffff811681146200101657600080fd5b6000806040838503121562002db757600080fd5b82356001600160401b0381111562002dce57600080fd5b62002ddc8582860162002c03565b95602094909401359450505050565b60408152600062002e00604083018562002d38565b905082151560208301529392505050565b60006020828403121562002e2457600080fd5b81356001600160401b0381111562002e3b57600080fd5b62002e498482850162002c03565b949350505050565b600082601f83011262002e6357600080fd5b813560206001600160401b0382111562002e815762002e8162002b90565b8160051b62002e9282820162002ba6565b928352848101820192828101908785111562002ead57600080fd5b83870192505b8483101562002ece5782358252918301919083019062002eb3565b979650505050505050565b60008060006060848603121562002eef57600080fd5b83356001600160401b038082111562002f0757600080fd5b62002f158783880162002c03565b9450602086013591508082111562002f2c57600080fd5b62002f3a8783880162002e51565b9350604086013591508082111562002f5157600080fd5b5062002f608682870162002e51565b9150509250925092565b6000806000806060858703121562002f8157600080fd5b84356001600160401b038082111562002f9957600080fd5b62002fa78883890162002c03565b955060208701359450604087013591508082111562002fc557600080fd5b5062002fd48782880162002c5f565b95989497509550505050565b634e487b7160e01b600052602160045260246000fd5b60208101600383106200300d576200300d62002fe0565b91905290565b600080604083850312156200302757600080fd5b50508035926020909101359150565b6000602082840312156200304957600080fd5b81356001600160a01b03811681146200101657600080fd5b8082018082111562000e725762000e7262002a75565b6020808252818101527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572604082015260600190565b601f8211156200092757600081815260208120601f850160051c81016020861015620030d55750805b601f850160051c820191505b8181101562001e7b57828155600101620030e1565b81516001600160401b0381111562003112576200311262002b90565b6200312a8162003123845462002acd565b84620030ac565b602080601f831160018114620031625760008415620031495750858301515b600019600386901b1c1916600185901b17855562001e7b565b600085815260208120601f198616915b82811015620031935788860151825594840194600190910190840162003172565b5085821015620031b25787850151600019600388901b60f8161c191681555b5050505050600190811b01905550565b600060208284031215620031d557600080fd5b5051919050565b600060208284031215620031ef57600080fd5b815167ffffffffffffffff19811681146200101657600080fd5b848152608081016002851062003223576200322362002fe0565b84602083015283604083015282606083015295945050505050565b6000602082840312156200325157600080fd5b81516001600160401b038111156200326857600080fd5b8201601f810184136200327a57600080fd5b80516200328b62002c268262002bd9565b818152856020838501011115620032a157600080fd5b620032b482602083016020860162002d12565b95945050505050565b600060018201620032d257620032d262002a75565b5060010190565b808202811582820484141762000e725762000e7262002a75565b600060ff821660ff81036200330c576200330c62002a75565b60010192915050565b6000826200333357634e487b7160e01b600052601260045260246000fd5b500490565b600084516200334c81846020890162002d12565b820183858237600093019283525090939250505056fe608060405260405161010b38038061010b83398101604081905261002291610041565b80518060208301f35b634e487b7160e01b600052604160045260246000fd5b6000602080838503121561005457600080fd5b82516001600160401b038082111561006b57600080fd5b818501915085601f83011261007f57600080fd5b8151818111156100915761009161002b565b604051601f8201601f19908116603f011681019083821181831017156100b9576100b961002b565b8160405282815288868487010111156100d157600080fd5b600093505b828410156100f357848401860151818501870152928501926100d6565b60008684830101528096505050505050509291505056fe6080604052348015600f57600080fd5b506004361060325760003560e01c80632b68b9c61460375780638da5cb5b14603f575b600080fd5b603d6081565b005b60657f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b03909116815260200160405180910390f35b336001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000161460ed5760405162461bcd60e51b815260206004820152600e60248201526d3737ba10333937b69037bbb732b960911b604482015260640160405180910390fd5b33fffea2646970667358221220fc66c9afb7cb2f6209ae28167cf26c6c06f86a82cbe3c56de99027979389a1be64736f6c63430008070033a264697066735822122074ecdb7c1356cd26b7ae20a002751e685b2c97645c0ec1b1214c316ec9516dce64736f6c63430008120033';\n        const factory = new ethers.ContractFactory(flatDirectoryBlobAbi, contractByteCode, this.#wallet);\n        try {\n            const contract = await factory.deploy(0, BLOB_DATA_SIZE, ethStorage, {gasLimit: 3800000});\n            await contract.waitForDeployment();\n\n            this.#contractAddr = await contract.getAddress();\n            console.log(`FlatDirectory Address: ${this.#contractAddr}`);\n            return this.#contractAddr;\n        } catch (e) {\n            console.error(`ERROR: deploy flat directory failed!`, e.message);\n            return null;\n        }\n    }\n\n    async deployDirectory(ethStorage) {\n        return this.#deploy(ethStorage);\n    }\n\n    async deployNormalDirectory() {\n        return this.deployDirectory(\"0x0000000000000000000000000000000000000000\");\n    }\n\n    async deploySepoliaDirectory() {\n        return this.deployDirectory(SEPOLIA_ETH_STORAGE);\n    }\n\n    async setDefaultFile(filename) {\n        if (!this.#contractAddr) {\n            console.error(`ERROR: flat directory not deployed!`);\n            return;\n        }\n\n        const hexName = filename ? stringToHex(filename) : \"0x\";\n        const fileContract = new ethers.Contract(this.#contractAddr, flatDirectoryBlobAbi, this.#wallet);\n        try {\n            const tx = await fileContract.setDefault(hexName);\n            console.log(`Transaction Id: ${tx.hash}`);\n            const txReceipt = await tx.wait();\n            if (txReceipt.status) {\n                console.log(`Set succeeds`);\n            } else {\n                console.error(`ERROR: set failed!`);\n            }\n        } catch (e) {\n            console.error(`ERROR: set failed!`, e.message);\n        }\n    }\n\n    async refund() {\n        if (!this.#contractAddr) {\n            console.error(`ERROR: flat directory not deployed!`);\n            return;\n        }\n\n        const fileContract = new ethers.Contract(this.#contractAddr, flatDirectoryBlobAbi, this.#wallet);\n        try {\n            const tx = await fileContract.refund();\n            console.log(`Transaction Id: ${tx.hash}`);\n            const txReceipt = await tx.wait();\n            if (txReceipt.status) {\n                console.log(`Refund succeeds`);\n            } else {\n                console.error(`ERROR: transaction failed!`);\n            }\n        } catch (e) {\n            console.error(`ERROR: transaction failed!`, e.message);\n        }\n    }\n\n    async remove(fileName) {\n        const fileContract = new ethers.Contract(this.#contractAddr, flatDirectoryBlobAbi, this.#wallet);\n        try {\n            const tx = await fileContract.remove(stringToHex(fileName));\n            console.log(`Transaction Id: ${tx.hash}`);\n            const receipt = await tx.wait();\n            if (receipt.status) {\n                console.log(`Remove file: ${fileName} succeeded`);\n                return true;\n            } else {\n                console.error(`ERROR: Failed to remove file: ${fileName}`);\n            }\n        } catch (e) {\n            console.error(`ERROR: Failed to remove file: ${fileName}`, e.message);\n        }\n        return false;\n    }\n\n    async #clearOldFile(fileContract, fileName, hexName, chunkLength) {\n        let oldChunkLength = await fileContract.countChunks(hexName);\n        if (oldChunkLength > chunkLength) {\n            // remove\n            const v = await this.remove(fileName);\n            if (v) {\n                return REMOVE_SUCCESS;\n            } else {\n                return REMOVE_FAIL;\n            }\n        } else if (oldChunkLength === 0) {\n            return REMOVE_SUCCESS;\n        } else {\n            return REMOVE_NORMAL;\n        }\n    }\n\n    async upload(fileOrPath) {\n        if (!this.#contractAddr) {\n            console.error(`ERROR: flat directory not deployed!`);\n            return;\n        }\n\n        const fileInfo = this.getFileInfo(fileOrPath);\n        if (!fileInfo.isFile) {\n            console.error(`ERROR: only upload file!`);\n            return;\n        }\n\n        const fileContract = new ethers.Contract(this.#contractAddr, flatDirectoryBlobAbi, this.#wallet);\n        const isSupport = await fileContract.isSupportBlob();\n        if (!isSupport) {\n            console.error(`ERROR: The current contract does not support blob upload!`);\n            return;\n        }\n\n        const fileSize = fileInfo.size;\n        const fileName = fileInfo.name;\n        const hexName = stringToHex(fileName);\n\n        const blobDataSize = BLOB_DATA_SIZE;\n        const blobLength = Math.ceil(fileSize / blobDataSize);\n\n        const clearState = await this.#clearOldFile(fileContract, fileName, hexName, blobLength);\n        if (clearState === REMOVE_FAIL) {\n            return {\n                totalChunkCount: blobLength,\n                successIndex: 0,\n                uploadSuccessCount: 0,\n                uploadFileSize: 0,\n                totalCost: 0,\n            };\n        }\n\n        const cost = await fileContract.upfrontPayment();\n        let successIndex = 0;\n        let uploadCount = 0;\n        let uploadFileSize = 0;\n        let totalCost = 0n;\n        for (let i = 0; i < blobLength; i += MAX_BLOB_COUNT) {\n            const content = await this.getFileChunk(fileOrPath, fileSize, i * blobDataSize, (i + MAX_BLOB_COUNT) * blobDataSize);\n            const blobs = EncodeBlobs(content);\n\n            const blobArr = [];\n            const indexArr = [];\n            const lenArr = [];\n            for (let j = 0; j < blobs.length; j++) {\n                blobArr.push(blobs[j]);\n                indexArr.push(i + j);\n                if (i + j === blobLength - 1) {\n                    lenArr.push(fileSize - blobDataSize * (blobLength - 1));\n                } else {\n                    lenArr.push(blobDataSize);\n                }\n            }\n\n            // check\n            if (clearState === REMOVE_NORMAL) {\n                let hasChange = false;\n                for (let j = 0; j < blobArr.length; j++) {\n                    const dataHash = await fileContract.getChunkHash(hexName, indexArr[j]);\n                    const localHash = await this.#blobUploader.getBlobHash(blobArr[j]);\n                    if (dataHash !== localHash) {\n                        hasChange = true;\n                        break;\n                    }\n                }\n                if (!hasChange) {\n                    successIndex += indexArr.length;\n                    console.log(`File ${fileName} chunkId: ${indexArr}: The data is not changed.`);\n                    continue;\n                }\n            }\n\n            // send\n            let success = false;\n            try {\n                const value = cost * BigInt(blobArr.length);\n                const tx = await fileContract.writeChunks.populateTransaction(hexName, indexArr, lenArr, {\n                    value\n                });\n                const hash = await this.#blobUploader.sendTx(tx, blobArr);\n                console.log(`Transaction Id: ${hash}`);\n\n                const txReceipt = await this.#blobUploader.getTxReceipt(hash);\n                if (txReceipt && txReceipt.status) {\n                    success = true;\n                    totalCost += value;\n                    uploadFileSize += BLOB_DATA_SIZE * indexArr.length;\n                    if (i + indexArr.length === blobLength) {\n                        uploadFileSize = uploadFileSize - BLOB_DATA_SIZE + lenArr[lenArr.length - 1];\n                    }\n                    uploadCount += indexArr.length;\n                    successIndex += indexArr.length;\n                    console.log(`File ${fileName} chunkId: ${indexArr} uploaded!`);\n                }\n            } catch (e) {\n                console.log('Error:' + e.message);\n            }\n            if (!success) {\n                break;\n            }\n        }\n        return {\n            totalChunkCount: blobLength,\n            successIndex: successIndex,\n            uploadSuccessCount: uploadCount,\n            uploadFileSize: uploadFileSize,\n            totalCost: totalCost,\n        }\n    }\n\n    async download(fileName, ethStorageRpc = ES_TEST_RPC) {\n        if (!this.#contractAddr) {\n            console.error(`ERROR: flat directory not deployed!`);\n            return;\n        }\n        return await DownloadFile(ethStorageRpc, this.#contractAddr, fileName);\n    }\n\n    getFileInfo(filePath) {}\n    async getFileChunk(filePath, fileSize, start, end) {}\n}\n","import fs from \"fs\";\nimport {BaseEthStorage} from \"./ethstorage\";\n\nexport class EthStorage extends BaseEthStorage{\n    getFileInfo(filePath) {\n        const fileStat = fs.statSync(filePath);\n        if (fileStat.isFile()) {\n            const name = filePath.substring(filePath.lastIndexOf(\"/\") + 1);\n            return {\n                isFile: true,\n                name: name,\n                size: fileStat.size\n            };\n        }\n        return {\n            isFile: false\n        };\n    }\n\n    async getFileChunk(filePath, fileSize, start, end) {\n        end = end > fileSize ? fileSize : end;\n        const length = end - start;\n        const buf = Buffer.alloc(length);\n        const fd = fs.openSync(filePath, 'r');\n        fs.readSync(fd, buf, 0, length, start);\n        fs.closeSync(fd);\n        return buf;\n    }\n}\n"],"names":["ethers","loadKZG","tx","common","Common","Hardfork","BlobEIP4844Transaction","stringToHex","Contract"],"mappings":"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"}